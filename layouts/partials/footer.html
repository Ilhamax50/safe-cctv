<footer class="footer">
  <div class="footer__inner">
    <div class="footer__content" style="text-align: center; font-size: 0.9em; color: #666; padding-top: 1em;">
      <p>&copy; {{ now.Year }} Safe CCTV</p>

      <div style="margin: 0.5em 0;">
        👁 <span id="firebase_site_views">0</span> views | 
        🧑‍🤝‍🧑 <span id="firebase_site_visitors">0</span> visitors
      </div>

      <p style="font-size: 0.8em; color: #999;">
        Dibangun dengan <a href="https://github.com/adityatelange/hugo-PaperMod" target="_blank">PaperMod</a> •
        <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a> •
        <a href="/kebijakan-privasi/">Privasi</a> •
        <a href="/ketentuan-penggunaan/">Ketentuan</a>
      </p>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
    import { getDatabase, ref, onValue, runTransaction } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBQg_DHBrxUqjbXyUoAFPWAIQuNZAD9wGs",
      authDomain: "safe-cctv-blog-post-like.firebaseapp.com",
      databaseURL: "https://safe-cctv-blog-post-like-default-rtdb.firebaseio.com",
      projectId: "safe-cctv-blog-post-like",
      storageBucket: "safe-cctv-blog-post-like.appspot.com",
      messagingSenderId: "985469144384",
      appId: "1:985469144384:web:653bf30ebc78239690bea5",
      measurementId: "G-DLGXGKW7WK"
    };

    // Inisialisasi Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Counter views global
    const siteViewsRef = ref(db, 'site_stats/views');
    runTransaction(siteViewsRef, (currentViews) => (currentViews || 0) + 1);
    onValue(siteViewsRef, (snapshot) => {
      const viewsEl = document.getElementById("firebase_site_views");
      if (viewsEl) viewsEl.textContent = snapshot.val() ?? 0;
    });

    // Counter unique visitors global
    const siteVisitorsRef = ref(db, 'site_stats/visitors');
    const visitorKey = 'firebase-unique-visitor';
    if (!localStorage.getItem(visitorKey)) {
      runTransaction(siteVisitorsRef, (currentVisitors) => (currentVisitors || 0) + 1);
      localStorage.setItem(visitorKey, 'true');
    }
    onValue(siteVisitorsRef, (snapshot) => {
      const visitorEl = document.getElementById("firebase_site_visitors");
      if (visitorEl) visitorEl.textContent = snapshot.val() ?? 0;
    });
  </script>
</footer>
